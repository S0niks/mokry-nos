<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Профиль</title>
  <link rel="stylesheet" href="assets/css/styles.css">
</head>
<body>
  <div id="navbar"></div>
  <h1>Профиль</h1>
  <div id="user-info"></div>
  <h2>Мои мероприятия</h2>
  <div id="event-container"></div>
  <script src="js/user.js"></script>
  <script>
    // Load navbar
    fetch('/components/navbar.html')
  .then(response => response.text())
  .then(data => document.getElementById('navbar').innerHTML = data)
  .catch(err => console.error('Ошибка загрузки навигации:', err));

    // Load user info
    const token = localStorage.getItem('token');
    if (token) {
      fetch('/api/users/profile', {
        headers: { 'Authorization': `Bearer ${token}` }
      })
        .then(response => response.json())
        .then(user => {
          document.getElementById('user-info').innerHTML = `
            <p>Имя: ${user.name}</p>
            <p>Email: ${user.email}</p>
            <p>Роль: ${user.role}</p>
          `;
        })
        .catch(() => window.location.href = 'login.html');
    } else {
      window.location.href = 'login.html';
    }

    // Load user events
    fetch('/api/events/my-events', {
      headers: { 'Authorization': `Bearer ${token}` }
    })
      .then(response => response.json())
      .then(events => {
        const container = document.getElementById('event-container');
        events.forEach(event => {
          const div = document.createElement('div');
          div.innerHTML = `<h3>${event.title}</h3><p>${event.description}</p><p>Дата: ${event.date}</p>`;
          container.appendChild(div);
        });
      });
  </script>
</body>
</html>